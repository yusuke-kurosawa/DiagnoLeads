# Core Features Specification - Change Proposal

**Date Created**: 2025-11-11  
**Status**: ğŸ“‹ Proposal (Ready for Review)  
**Priority**: ğŸ”´ Critical  
**Estimated Effort**: 4 weeks

---

## ğŸ¯ Purpose

DiagnoLeadsã®ã‚³ã‚¢æ©Ÿèƒ½ï¼ˆã‚·ã‚¹ãƒ†ãƒ å…±é€šã€è¨ºæ–­ç®¡ç†ã€ãƒªãƒ¼ãƒ‰ç®¡ç†ï¼‰ã®åŒ…æ‹¬çš„ãªæ©Ÿèƒ½ä»•æ§˜ã‚’å®šç¾©ã—ã€ç¾åœ¨ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®å•é¡Œã‚’è§£æ±ºã—ã¾ã™ã€‚

## ğŸ” Problem Statement

**ç¾çŠ¶ã®å•é¡Œ:**
- âœ— è¨ºæ–­ä½œæˆãƒšãƒ¼ã‚¸ã«é·ç§»ã§ããªã„ï¼ˆãƒ«ãƒ¼ãƒˆæœªå®šç¾©ï¼‰
- âœ— ãƒªãƒ¼ãƒ‰ç®¡ç†ãƒšãƒ¼ã‚¸ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãŒä¸å®Œå…¨
- âœ— ã‚·ã‚¹ãƒ†ãƒ å…±é€šæ©Ÿèƒ½ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ‘ãƒ³ããšç­‰ï¼‰ã®ä»•æ§˜ãŒä¸æ˜ç¢º
- âœ— å®Ÿè£…ã¨OpenSpecä»•æ§˜ã®ä¹–é›¢

**å½±éŸ¿:**
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåŸºæœ¬çš„ãªæ©Ÿèƒ½ã‚’ä½¿ç”¨ã§ããªã„
- é–‹ç™ºãƒãƒ¼ãƒ ãŒå®Ÿè£…ã®æŒ‡é‡ã‚’æŒã¦ãªã„
- ãƒ†ã‚¹ãƒˆã®åŸºæº–ãŒä¸æ˜ç¢º

## ğŸ“¦ Deliverables

ã“ã®å¤‰æ›´ææ¡ˆã«ã¯4ã¤ã®è©³ç´°ä»•æ§˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå«ã¾ã‚Œã¾ã™ï¼š

### 1. Core Features Proposal
**File**: `core-features-proposal.md` (8.7KB)  
**Purpose**: å…¨ä½“ã®å¤‰æ›´ææ¡ˆã€ç›®æ¨™ã€å®Ÿè£…è¨ˆç”»

**å†…å®¹:**
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
- 8ã¤ã®User Stories
- æˆåŠŸåŸºæº–
- 4é€±é–“ã®å®Ÿè£…è¨ˆç”»
- ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### 2. System Core Features
**File**: `system-core.md` (12.7KB)  
**Purpose**: ã‚·ã‚¹ãƒ†ãƒ å…±é€šæ©Ÿèƒ½ã®è©³ç´°ä»•æ§˜

**å†…å®¹:**
- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³æ§‹é€ 
- ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å®šç¾©
- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- èªè¨¼ãƒ•ãƒ­ãƒ¼
- ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ
- ãƒ†ãƒŠãƒ³ãƒˆåˆ‡ã‚Šæ›¿ãˆ

**ä¸»è¦ä»•æ§˜:**
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
- ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆç®¡ç†
- ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆã®è‡ªå‹•ç”Ÿæˆ
- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œï¼ˆWCAG 2.1 AAï¼‰

### 3. Assessment Features
**File**: `assessment-features.md` (18.7KB)  
**Purpose**: è¨ºæ–­æ©Ÿèƒ½ã®å®Œå…¨ä»•æ§˜

**å†…å®¹:**
- è¨ºæ–­CRUDæ“ä½œ
- ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆãƒ“ãƒ«ãƒ€ãƒ¼
- è³ªå•ã‚¿ã‚¤ãƒ—ï¼ˆå˜ä¸€/è¤‡æ•°é¸æŠã€ãƒ†ã‚­ã‚¹ãƒˆã€ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼‰
- ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«
- å…¬é–‹/éå…¬é–‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- ã‚ªãƒ¼ãƒˆã‚»ãƒ¼ãƒ–æ©Ÿèƒ½

**ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ:**
```
- AssessmentsPage (ä¸€è¦§)
- CreateAssessmentPage (ä½œæˆ)
- EditAssessmentPage (ç·¨é›†)
- AssessmentBuilder (ãƒ“ãƒ«ãƒ€ãƒ¼UI)
  - QuestionList (ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—)
  - QuestionEditor
  - SettingsPanel
```

### 4. Lead Management Features
**File**: `lead-management-features.md` (27.9KB)  
**Purpose**: ãƒªãƒ¼ãƒ‰ç®¡ç†æ©Ÿèƒ½ã®å®Œå…¨ä»•æ§˜

**å†…å®¹:**
- ãƒªãƒ¼ãƒ‰ä¸€è¦§ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¤œç´¢ï¼‰
- ãƒ›ãƒƒãƒˆãƒªãƒ¼ãƒ‰æ¤œå‡ºï¼ˆã‚¹ã‚³ã‚¢ >= 80ï¼‰
- ãƒªãƒ¼ãƒ‰è©³ç´°ãƒšãƒ¼ã‚¸
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
- Microsoft Teamsé€šçŸ¥é€£æº

**ä¸»è¦æ©Ÿèƒ½:**
```
- Lead List with advanced filters
- Hot Lead highlighting (ğŸ”¥ icon)
- Score breakdown display
- Status workflow (NEW â†’ CONTACTED â†’ QUALIFIED â†’ NEGOTIATION â†’ WON/LOST)
- Teams auto-notification for hot leads
```

---

## ğŸ“Š Specifications Summary

| Specification | Lines | Size | User Stories | Components | API Endpoints |
|--------------|-------|------|--------------|------------|---------------|
| Core Proposal | 269 | 8.7KB | 8 | - | - |
| System Core | 516 | 12.7KB | 4 | 6 | 2 |
| Assessment Features | 746 | 18.7KB | 5 | 8 | 7 |
| Lead Management | 895 | 27.9KB | 7 | 12 | 7 |
| **Total** | **2,426** | **68KB** | **24** | **26** | **16** |

---

## ğŸ¯ Success Criteria

### System Core
- [ ] ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã«ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- [ ] ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆãŒæ­£ã—ãè¡¨ç¤º
- [ ] ãƒ­ã‚°ã‚¤ãƒ³/ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãŒæ­£å¸¸å‹•ä½œ
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³å¯¾å¿œï¼ˆãƒ¢ãƒã‚¤ãƒ«/ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ/ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ï¼‰

### Assessment Features
- [ ] è¨ºæ–­ä¸€è¦§ãƒšãƒ¼ã‚¸ã§è¨ºæ–­ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] è¨ºæ–­ä½œæˆãƒ•ã‚©ãƒ¼ãƒ ãŒå‹•ä½œã™ã‚‹
- [ ] ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ“ãƒ«ãƒ€ãƒ¼ã§è³ªå•ã‚’è¿½åŠ ãƒ»ç·¨é›†ã§ãã‚‹
- [ ] ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§è³ªå•ã‚’ä¸¦ã³æ›¿ãˆã‚‰ã‚Œã‚‹
- [ ] å…¬é–‹/éå…¬é–‹ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹
- [ ] ã‚ªãƒ¼ãƒˆã‚»ãƒ¼ãƒ–ãŒå‹•ä½œã™ã‚‹ï¼ˆ3ç§’ãŠãï¼‰

### Lead Management
- [ ] ãƒªãƒ¼ãƒ‰ä¸€è¦§ã§ãƒªãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ãƒ›ãƒƒãƒˆãƒªãƒ¼ãƒ‰ï¼ˆã‚¹ã‚³ã‚¢ >= 80ï¼‰ãŒãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤º
- [ ] ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€ã‚¹ã‚³ã‚¢ã€æ—¥ä»˜ï¼‰ãŒå‹•ä½œ
- [ ] ãƒªãƒ¼ãƒ‰è©³ç´°ãƒšãƒ¼ã‚¸ã§ã‚¹ã‚³ã‚¢å†…è¨³ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°ã§ãã‚‹
- [ ] ãƒ›ãƒƒãƒˆãƒªãƒ¼ãƒ‰ä½œæˆæ™‚ã«Teamsé€šçŸ¥ãŒé€ä¿¡ã•ã‚Œã‚‹

---

## ğŸš€ Implementation Plan

### Phase 1: System Core (Week 1)
**Goal**: å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…

**Tasks:**
- [ ] Layout component with sidebar
- [ ] Navigation component with routing
- [ ] Breadcrumbs component
- [ ] Protected route enhancement
- [ ] Responsive design implementation

**Deliverables:**
- Working navigation across all pages
- Breadcrumbs on all pages
- Mobile-responsive sidebar

### Phase 2: Assessment Features (Week 2-3)
**Goal**: è¨ºæ–­æ©Ÿèƒ½ã®å®Œå…¨å®Ÿè£…

**Tasks:**
- [ ] Assessment list page with filters
- [ ] Assessment creation flow
- [ ] Visual assessment builder
  - [ ] Question list (drag & drop)
  - [ ] Question editor
  - [ ] Settings panel
- [ ] Publish/unpublish workflow
- [ ] Auto-save functionality
- [ ] Preview mode

**Deliverables:**
- Functional assessment CRUD
- Working visual builder
- Published assessment URLs

### Phase 3: Lead Management (Week 4)
**Goal**: ãƒªãƒ¼ãƒ‰ç®¡ç†æ©Ÿèƒ½ã®å®Œå…¨å®Ÿè£…

**Tasks:**
- [ ] Lead list page with filters
- [ ] Lead detail page
  - [ ] Basic info card
  - [ ] Score breakdown
  - [ ] Activity timeline
  - [ ] Notes section
- [ ] Status management workflow
- [ ] Hot lead highlighting
- [ ] Teams notification integration
- [ ] Manual lead creation

**Deliverables:**
- Functional lead management
- Hot lead detection & Teams notifications
- Complete status workflow

---

## ğŸ§ª Testing Strategy

### Unit Tests
**Components:**
- [ ] Sidebar navigation
- [ ] Breadcrumbs generator
- [ ] AssessmentBuilder
- [ ] QuestionEditor
- [ ] LeadTable
- [ ] LeadFilters

**Services:**
- [ ] Auth store
- [ ] Assessment queries
- [ ] Lead queries
- [ ] Teams notification

### Integration Tests
**Flows:**
- [ ] Full navigation flow
- [ ] Assessment creation flow
- [ ] Lead management flow
- [ ] Status update flow

### E2E Tests
**Scenarios:**
- [ ] Login â†’ Create Assessment â†’ Publish
- [ ] Login â†’ View Leads â†’ Filter â†’ Detail
- [ ] Create Hot Lead â†’ Verify Teams Notification

---

## ğŸ“ˆ Performance Targets

| Metric | Target | Notes |
|--------|--------|-------|
| Page Load (Initial) | < 2s | First contentful paint |
| Page Transition | < 500ms | Route navigation |
| Filter Application | < 500ms | Real-time filtering |
| API Response | < 200ms (p95) | Backend response time |
| Auto-save Debounce | 3s | Prevent excessive saves |
| Teams Notification | < 2s | Async, non-blocking |

---

## ğŸ”’ Security & Compliance

### Multi-Tenant Isolation
- ã™ã¹ã¦ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«tenantIdã‚’å«ã‚ã‚‹
- Row-Level Security (RLS)ã§å¼·åˆ¶çš„ã«ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢
- URLã«`:tenantId`ã‚’å«ã‚ã¦ã‚¹ã‚³ãƒ¼ãƒ—ã‚’æ˜ç¢ºåŒ–

### Authentication
- JWT-based authentication
- Protected route guards
- Automatic logout on token expiration
- Secure session management

### Data Privacy
- ãƒªãƒ¼ãƒ‰ã®å€‹äººæƒ…å ±ã‚’æš—å·åŒ–
- GDPRæº–æ‹ ï¼ˆå‰Šé™¤æ¨©ã€å¿˜ã‚Œã‚‰ã‚Œã‚‹æ¨©åˆ©ï¼‰
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ­ã‚°ã®ç›£æŸ»è¨¼è·¡

---

## ğŸ“š Related Documentation

### OpenSpec Guidelines
- [OPENSPEC_BEST_PRACTICES.md](../../../docs/OPENSPEC_BEST_PRACTICES.md)
- [OPENSPEC_QUICK_REFERENCE.md](../../../docs/OPENSPEC_QUICK_REFERENCE.md)
- [OPENSPEC_DROID_STRATEGY.md](../../../docs/OPENSPEC_DROID_STRATEGY.md)

### Existing Specifications
- [Authentication](../../specs/auth/authentication.md)
- [Multi-Tenant](../../specs/auth/multi-tenant.md)
- [Microsoft Teams Integration](../../specs/features/microsoft-teams-integration.md)
- [AI Support](../../specs/features/ai-support.md)

---

## ğŸ¨ Design Assets

### Wireframes
- System Core: Sidebar, Header, Breadcrumbs layout
- Assessment Builder: 3-column layout (Questions, Editor, Settings)
- Lead Detail: Tabbed interface (Overview, Assessment, Activity)

### UI Components (shadcn/ui)
- Button, Card, Badge
- Table, Pagination
- Select, MultiSelect, DateRangePicker
- Dialog, Dropdown, Tooltip

---

## ğŸ‘¥ Review & Approval Process

### Reviewers
- **Product Owner**: Business requirements validation
- **Tech Lead**: Technical feasibility review
- **UX Designer**: UI/UX design review
- **QA Lead**: Test strategy review

### Review Checklist
- [ ] Business requirements clear and complete
- [ ] User stories cover all scenarios
- [ ] Technical design feasible
- [ ] API design consistent with existing patterns
- [ ] UI/UX mockups align with specifications
- [ ] Test strategy comprehensive
- [ ] Performance targets realistic
- [ ] Security considerations addressed

---

## ğŸ“ Next Steps

### Immediate (This Week)
1. **Review**: Product Owner, Tech Lead, UX Designer review specifications
2. **Feedback**: Gather feedback and refine specifications
3. **Approval**: Get formal approval to proceed

### Implementation (Week 1-4)
1. **Week 1**: System Core implementation
2. **Week 2-3**: Assessment Features implementation
3. **Week 4**: Lead Management implementation

### Post-Implementation
1. **Testing**: Complete unit, integration, E2E tests
2. **Documentation**: Update user documentation
3. **Archive**: Move approved specs to `openspec/specs/`

---

## ğŸ”— Quick Links

- **GitHub Issue**: #TBD
- **Figma Design**: TBD
- **Project Board**: TBD
- **Slack Channel**: #diagnoleads-dev

---

## âœ… Approval

| Role | Name | Date | Status |
|------|------|------|--------|
| Product Owner | TBD | - | â³ Pending |
| Tech Lead | TBD | - | â³ Pending |
| UX Designer | TBD | - | â³ Pending |
| QA Lead | TBD | - | â³ Pending |

---

**Status**: ğŸ“‹ Ready for Review  
**Created by**: Droid (Factory AI Assistant)  
**Date**: 2025-11-11

---

## ğŸ“ Questions?

For questions about these specifications, please:
1. Review the individual spec files for detailed information
2. Check the related OpenSpec documentation
3. Contact the Product Owner or Tech Lead

**Let's build amazing features! ğŸš€**

# Specé§†å‹•é–‹ç™ºæˆ¦ç•¥ - OpenSpec + OpenAPIçµ±åˆ

DiagnoLeadsã§ã¯**OpenSpec**ã¨**OpenAPI**ã®ä¸¡æ–¹ã‚’æ¡ç”¨ã—ã€ãã‚Œãã‚Œã®å¼·ã¿ã‚’æ´»ã‹ã—ãŸå®Œå…¨ãªSpecé§†å‹•é–‹ç™ºã‚’å®Ÿç¾ã—ã¾ã™ã€‚

## ğŸ¯ 2ã¤ã®Specã®å½¹å‰²åˆ†æ‹…

### OpenSpecï¼ˆby Fission-AIï¼‰
**äººé–“ã¨AIã®ãŸã‚ã®ä»•æ§˜æ›¸**

- **å¯¾è±¡**: æ©Ÿèƒ½ä»•æ§˜ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã€UI/UXè¨­è¨ˆ
- **å½¢å¼**: Markdownï¼ˆäººé–“ãŒèª­ã¿ã‚„ã™ã„ï¼‰
- **å ´æ‰€**: `openspec/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
- **ç”¨é€”**: 
  - æ©Ÿèƒ½ã®ææ¡ˆãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ‰¿èª
  - å®Ÿè£…å‰ã®è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
  - ãƒãƒ¼ãƒ é–“ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³
  - AI coding assistantã¸ã®æŒ‡ç¤º

### OpenAPI Specification
**æ©Ÿæ¢°å®Ÿè¡Œå¯èƒ½ãªAPIä»•æ§˜**

- **å¯¾è±¡**: REST API ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ã‚¹ã‚­ãƒ¼ãƒã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹
- **å½¢å¼**: JSON/YAMLï¼ˆæ©Ÿæ¢°ãŒèª­ã¿ã‚„ã™ã„ï¼‰
- **å ´æ‰€**: `openapi.json`
- **ç”¨é€”**:
  - å‹ã®è‡ªå‹•ç”Ÿæˆ
  - APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è‡ªå‹•ç”Ÿæˆ
  - Contract Testing
  - APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è‡ªå‹•ç”Ÿæˆ

## ğŸ”„ çµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    1. OpenSpec Proposal                      â”‚
â”‚                  (äººé–“ãŒèª­ã‚ã‚‹ä»•æ§˜æ›¸)                          â”‚
â”‚                                                               â”‚
â”‚  openspec/changes/feature-name.md                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ # New Feature: Lead Management                      â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚ ## Overview                                          â”‚    â”‚
â”‚  â”‚ ãƒªãƒ¼ãƒ‰ç®¡ç†æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹                              â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚ ## API Endpoints                                     â”‚    â”‚
â”‚  â”‚ - POST /api/v1/tenants/{id}/leads                   â”‚    â”‚
â”‚  â”‚ - GET /api/v1/tenants/{id}/leads                    â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚ ## Data Model                                        â”‚    â”‚
â”‚  â”‚ - Lead: name, email, status, score                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                      Review & Approve
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 2. OpenSpec Specification                    â”‚
â”‚                  (æ‰¿èªæ¸ˆã¿ä»•æ§˜ = å®Ÿè£…ã®åŸºæº–)                  â”‚
â”‚                                                               â”‚
â”‚  openspec/specs/features/lead-management.md                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    Implementation
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              3. Backend Implementation (FastAPI)             â”‚
â”‚                                                               â”‚
â”‚  backend/app/api/v1/leads.py                                 â”‚
â”‚  backend/app/models/lead.py                                  â”‚
â”‚  backend/app/schemas/lead.py                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    Auto-Generate
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           4. OpenAPI Specification (è‡ªå‹•ç”Ÿæˆ)                â”‚
â”‚              (æ©Ÿæ¢°å®Ÿè¡Œå¯èƒ½ãªAPIä»•æ§˜)                          â”‚
â”‚                                                               â”‚
â”‚  openapi.json                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ {                                                   â”‚    â”‚
â”‚  â”‚   "paths": {                                        â”‚    â”‚
â”‚  â”‚     "/api/v1/tenants/{id}/leads": {                â”‚    â”‚
â”‚  â”‚       "post": {                                     â”‚    â”‚
â”‚  â”‚         "operationId": "createLead",               â”‚    â”‚
â”‚  â”‚         "requestBody": { "$ref": "#/..." }        â”‚    â”‚
â”‚  â”‚       }                                             â”‚    â”‚
â”‚  â”‚     }                                                â”‚    â”‚
â”‚  â”‚   }                                                  â”‚    â”‚
â”‚  â”‚ }                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    Auto-Generate
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        5. Frontend Types (TypeScriptå‹ - è‡ªå‹•ç”Ÿæˆ)           â”‚
â”‚                                                               â”‚
â”‚  frontend/src/types/api.generated.ts                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ export interface Lead {                             â”‚    â”‚
â”‚  â”‚   id: string;                                        â”‚    â”‚
â”‚  â”‚   name: string;                                      â”‚    â”‚
â”‚  â”‚   email: string;                                     â”‚    â”‚
â”‚  â”‚   status: 'new' | 'contacted' | 'qualified';       â”‚    â”‚
â”‚  â”‚ }                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                    Implementation
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              6. Frontend Implementation (React)              â”‚
â”‚                                                               â”‚
â”‚  frontend/src/components/leads/LeadList.tsx                  â”‚
â”‚  (å‹å®‰å…¨ãªã‚³ãƒ¼ãƒ‰)                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                        Archive
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  7. OpenSpec Archive                         â”‚
â”‚                                                               â”‚
â”‚  openspec/archive/2025-01-10-lead-management.md              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ å…·ä½“çš„ãªä½¿ã„åˆ†ã‘

### OpenSpecã§å®šç¾©ã™ã‚‹ã“ã¨

âœ… **æ©Ÿèƒ½ä»•æ§˜**
```markdown
# Lead Management Feature

## User Story
å–¶æ¥­æ‹…å½“è€…ã¨ã—ã¦ã€è¦‹è¾¼ã¿å®¢ã‚’ç®¡ç†ã—ãŸã„ã€‚
so that åŠ¹ç‡çš„ã«ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã§ãã‚‹ã€‚

## Requirements
- ãƒªãƒ¼ãƒ‰ã®ä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ï¼ˆæ–°è¦ã€ã‚³ãƒ³ã‚¿ã‚¯ãƒˆæ¸ˆã¿ã€æˆç´„ï¼‰
- ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°æ©Ÿèƒ½
```

âœ… **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯**
```markdown
## Lead Scoring Logic
- ãƒ¡ãƒ¼ãƒ«é–‹å°: +10ç‚¹
- ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯: +20ç‚¹
- ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡: +50ç‚¹
- åˆè¨ˆ100ç‚¹ä»¥ä¸Š: "Hot Lead"
```

âœ… **UI/UXè¨­è¨ˆ**
```markdown
## UI Components
- LeadList: ã‚«ãƒ¼ãƒ‰å½¢å¼ã€ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½
- LeadDetail: ã‚¿ãƒ–å½¢å¼ï¼ˆåŸºæœ¬æƒ…å ±ã€æ´»å‹•å±¥æ­´ã€ã‚¹ã‚³ã‚¢ï¼‰
- LeadForm: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€è‡ªå‹•ä¿å­˜
```

âœ… **ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼**
```markdown
## Data Flow
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
3. Leadãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜
4. ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°è¨ˆç®—
5. é€šçŸ¥é€ä¿¡ï¼ˆã‚¹ã‚³ã‚¢ãŒé–¾å€¤ä»¥ä¸Šã®å ´åˆï¼‰
```

### OpenAPIã§å®šç¾©ã™ã‚‹ã“ã¨

âœ… **APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**
```json
{
  "paths": {
    "/api/v1/tenants/{tenant_id}/leads": {
      "post": {
        "operationId": "createLead",
        "summary": "Create a new lead",
        "parameters": [...],
        "requestBody": {...},
        "responses": {...}
      }
    }
  }
}
```

âœ… **ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒ**
```json
{
  "components": {
    "schemas": {
      "Lead": {
        "type": "object",
        "required": ["id", "name", "email"],
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "name": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "status": {
            "type": "string",
            "enum": ["new", "contacted", "qualified", "converted"]
          }
        }
      }
    }
  }
}
```

âœ… **ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```json
{
  "responses": {
    "400": {
      "description": "Invalid request",
      "content": {
        "application/json": {
          "schema": { "$ref": "#/components/schemas/ErrorResponse" }
        }
      }
    }
  }
}
```

## ğŸ¯ ãã‚Œãã‚Œã®åˆ©ç‚¹

### OpenSpecã®åˆ©ç‚¹

1. **äººé–“ãŒèª­ã¿ã‚„ã™ã„**: Markdownã§è‡ªç„¶è¨€èª
2. **æŸ”è»Ÿæ€§**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã€UIè¨­è¨ˆãªã©ä½•ã§ã‚‚è¨˜è¿°å¯èƒ½
3. **ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒãƒ¼ãƒ é–“ã®å…±é€šç†è§£
4. **AIæŒ‡ç¤º**: Claudeç­‰ã¸ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæä¾›
5. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: Git diffã§å·®åˆ†ãŒè¦‹ã‚„ã™ã„

### OpenAPIã®åˆ©ç‚¹

1. **å‹å®‰å…¨æ€§**: è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸå‹ã§100%ã®å‹å®‰å…¨æ€§
2. **è‡ªå‹•åŒ–**: ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã€æ¤œè¨¼ãŒå®Œå…¨è‡ªå‹•
3. **æ¨™æº–åŒ–**: æ¥­ç•Œæ¨™æº–ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
4. **ãƒ„ãƒ¼ãƒ«é€£æº**: Swagger UIã€Postmanç­‰ã¨çµ±åˆ
5. **Contract Testing**: è‡ªå‹•çš„ã«ä»•æ§˜ã¨ã®ä¸€è‡´ã‚’æ¤œè¨¼

## ğŸ› ï¸ ãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³

### OpenSpecé–¢é€£
```bash
# ææ¡ˆä½œæˆ
# openspec/changes/ ã«Markdownãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

# ä»•æ§˜ç¢ºèª
cat openspec/specs/features/feature-name.md

# ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
mv openspec/changes/feature.md openspec/archive/$(date +%Y-%m-%d)-feature.md
```

### OpenAPIé–¢é€£
```bash
# OpenAPIä»•æ§˜ç”Ÿæˆï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰è‡ªå‹•ï¼‰
cd backend
python scripts/generate_openapi.py

# TypeScriptå‹ç”Ÿæˆï¼ˆOpenAPIã‹ã‚‰è‡ªå‹•ï¼‰
cd frontend
npm run generate:types

# ä»•æ§˜æ¤œè¨¼
npm run validate:openapi
```

## ğŸ“‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
DiagnoLeads/
â”œâ”€â”€ openspec/                          # OpenSpec (äººé–“ã®ãŸã‚ã®ä»•æ§˜)
â”‚   â”œâ”€â”€ specs/                        # æ‰¿èªæ¸ˆã¿ä»•æ§˜ï¼ˆå®Ÿè£…ã®åŸºæº–ï¼‰
â”‚   â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment-crud.md
â”‚   â”‚   â”‚   â””â”€â”€ lead-management.md
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ endpoints-overview.md
â”‚   â”‚   â””â”€â”€ architecture/
â”‚   â”‚       â””â”€â”€ multi-tenant.md
â”‚   â”œâ”€â”€ changes/                      # ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸­ã®å¤‰æ›´ææ¡ˆ
â”‚   â”‚   â””â”€â”€ proposal-new-feature.md
â”‚   â””â”€â”€ archive/                      # å®Œäº†ã—ãŸå¤‰æ›´
â”‚       â””â”€â”€ 2025-01-10-assessment-crud.md
â”‚
â”œâ”€â”€ openapi.json                       # OpenAPI (æ©Ÿæ¢°ã®ãŸã‚ã®ä»•æ§˜)
â”‚                                      # â† FastAPIã‹ã‚‰è‡ªå‹•ç”Ÿæˆ
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â””â”€â”€ generate_openapi.py       # OpenAPIç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ app/
â”‚       â”œâ”€â”€ api/                      # FastAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚       â”œâ”€â”€ models/                   # SQLAlchemyãƒ¢ãƒ‡ãƒ«
â”‚       â””â”€â”€ schemas/                  # Pydanticã‚¹ã‚­ãƒ¼ãƒ
â”‚
â””â”€â”€ frontend/
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ types/
    â”‚   â”‚   â””â”€â”€ api.generated.ts      # â† OpenAPIã‹ã‚‰è‡ªå‹•ç”Ÿæˆ
    â”‚   â””â”€â”€ components/
    â””â”€â”€ package.json
```

## ğŸ”„ é–‹ç™ºãƒ•ãƒ­ãƒ¼ï¼ˆçµ±åˆç‰ˆï¼‰

### Phase 1: OpenSpec Proposalï¼ˆä»•æ§˜ææ¡ˆï¼‰

```bash
# 1. æ–°æ©Ÿèƒ½ã®ææ¡ˆã‚’OpenSpecã§è¨˜è¿°
vim openspec/changes/lead-management.md
```

```markdown
# Feature Proposal: Lead Management

## Overview
ãƒªãƒ¼ãƒ‰ï¼ˆè¦‹è¾¼ã¿å®¢ï¼‰ã‚’ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ 

## User Stories
- å–¶æ¥­æ‹…å½“è€…ã¨ã—ã¦ã€ãƒªãƒ¼ãƒ‰ã‚’ç™»éŒ²ãƒ»ç®¡ç†ã—ãŸã„
- ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æ‹…å½“è€…ã¨ã—ã¦ã€ãƒªãƒ¼ãƒ‰ã‚’ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã—ãŸã„

## API Endpoints (æ¦‚è¦)
- POST /api/v1/tenants/{id}/leads - ãƒªãƒ¼ãƒ‰ä½œæˆ
- GET /api/v1/tenants/{id}/leads - ãƒªãƒ¼ãƒ‰ä¸€è¦§
- GET /api/v1/tenants/{id}/leads/{id} - ãƒªãƒ¼ãƒ‰è©³ç´°

## Data Model (æ¦‚è¦)
- Lead
  - name: string
  - email: string
  - status: enum
  - score: number
```

### Phase 2: Review & Approveï¼ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ‰¿èªï¼‰

```bash
# 2. ãƒãƒ¼ãƒ ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆPull Requestç­‰ï¼‰
# 3. æ‰¿èªå¾Œã€specs/ã«ç§»å‹•
mv openspec/changes/lead-management.md \
   openspec/specs/features/lead-management.md
```

### Phase 3: Backend Implementationï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…ï¼‰

```bash
# 4. OpenSpecä»•æ§˜ã‚’è¦‹ãªãŒã‚‰å®Ÿè£…
cat openspec/specs/features/lead-management.md

# 5. FastAPIã§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
# backend/app/api/v1/leads.py
# backend/app/models/lead.py
# backend/app/schemas/lead.py
```

### Phase 4: OpenAPI Auto-Generationï¼ˆOpenAPIè‡ªå‹•ç”Ÿæˆï¼‰

```bash
# 6. FastAPIã‹ã‚‰è‡ªå‹•çš„ã«OpenAPIä»•æ§˜ã‚’ç”Ÿæˆ
cd backend
python scripts/generate_openapi.py
# â†’ openapi.json ãŒæ›´æ–°ã•ã‚Œã‚‹
```

### Phase 5: Frontend Types Generationï¼ˆå‹è‡ªå‹•ç”Ÿæˆï¼‰

```bash
# 7. OpenAPIã‹ã‚‰TypeScriptå‹ã‚’è‡ªå‹•ç”Ÿæˆ
cd frontend
npm run generate:types
# â†’ src/types/api.generated.ts ãŒæ›´æ–°ã•ã‚Œã‚‹
```

### Phase 6: Frontend Implementationï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…ï¼‰

```typescript
// 8. ç”Ÿæˆã•ã‚ŒãŸå‹ã‚’ä½¿ã£ã¦å®Ÿè£…ï¼ˆå‹å®‰å…¨ï¼‰
import type { Lead } from '@/types/api.generated';

const lead: Lead = {
  id: '...',
  name: '...',
  email: '...',
  status: 'new' // å‹ãƒã‚§ãƒƒã‚¯ã•ã‚Œã‚‹
};
```

### Phase 7: Testing & Archiveï¼ˆãƒ†ã‚¹ãƒˆãƒ»ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼‰

```bash
# 9. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test

# 10. å®Œäº†å¾Œã€OpenSpecã‚’ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
mv openspec/specs/features/lead-management.md \
   openspec/archive/$(date +%Y-%m-%d)-lead-management.md
```

## ğŸ¯ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### DO âœ…

1. **OpenSpecã‹ã‚‰å§‹ã‚ã‚‹**: ã¾ãšäººé–“ãŒèª­ã‚ã‚‹ä»•æ§˜æ›¸ã‚’æ›¸ã
2. **OpenAPIã¯è‡ªå‹•ç”Ÿæˆ**: æ‰‹å‹•ã§æ›¸ã‹ãªã„ã€FastAPIã‹ã‚‰ç”Ÿæˆ
3. **å‹ã¯è‡ªå‹•ç”Ÿæˆ**: TypeScriptå‹ã‚‚æ‰‹å‹•ã§æ›¸ã‹ãªã„
4. **ä¸¡æ–¹ã‚’æœ€æ–°ã«ä¿ã¤**: å®Ÿè£…å¤‰æ›´æ™‚ã¯ä¸¡æ–¹ã‚’æ›´æ–°
5. **OpenSpecã§ãƒ¬ãƒ“ãƒ¥ãƒ¼**: Pull Requestã§ã¯äººé–“ãŒèª­ã‚ã‚‹OpenSpecã‚’ç¢ºèª
6. **OpenAPIã§æ¤œè¨¼**: CI/CDã§è‡ªå‹•çš„ã«å‹ã¨ä»•æ§˜ã®ä¸€è‡´ã‚’ç¢ºèª

### DON'T âŒ

1. **OpenAPIã‚’æ‰‹æ›¸ãã—ãªã„**: FastAPIã‹ã‚‰è‡ªå‹•ç”ŸæˆãŒæ­£
2. **OpenSpecã‚’çœç•¥ã—ãªã„**: å®Ÿè£…ã ã‘ã§ã¯ãªãã€ãªãœãã®è¨­è¨ˆãªã®ã‹ã‚’è¨˜éŒ²
3. **å‹ã‚’æ‰‹å‹•å®šç¾©ã—ãªã„**: å¿…ãšè‡ªå‹•ç”Ÿæˆã‚’ä½¿ã†
4. **ä»•æ§˜ãªã—ã§å®Ÿè£…ã—ãªã„**: Spec Firstã®åŸå‰‡ã‚’å®ˆã‚‹

## ğŸ”§ Factory Droidçµ±åˆ

ä¸¡æ–¹ã®Specã‚’è‡ªå‹•çš„ã«ç®¡ç†ã™ã‚‹`spec-sync` DroidãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ï¼š

```yaml
# .factory/droids/spec-sync.yml
- OpenSpecã®æ§‹é€ æ¤œè¨¼
- OpenSpec â†” å®Ÿè£…ã®åŒæœŸç¢ºèª
- OpenAPIã®è‡ªå‹•ç”Ÿæˆ
- TypeScriptå‹ã®è‡ªå‹•ç”Ÿæˆ
- CI/CDçµ±åˆ
```

## ğŸ“š ã¾ã¨ã‚

| é …ç›® | OpenSpec | OpenAPI |
|------|----------|---------|
| **å¯¾è±¡èª­è€…** | äººé–“ï¼ˆé–‹ç™ºè€…ã€PMã€ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ï¼‰ | æ©Ÿæ¢°ï¼ˆã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã€ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ï¼‰ |
| **å½¢å¼** | Markdown | JSON |
| **å†…å®¹** | æ©Ÿèƒ½ä»•æ§˜ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã€UI/UX | APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ã‚¹ã‚­ãƒ¼ãƒ |
| **ä½œæˆæ–¹æ³•** | æ‰‹å‹•ï¼ˆã‚¨ãƒ‡ã‚£ã‚¿ï¼‰ | è‡ªå‹•ç”Ÿæˆï¼ˆFastAPIï¼‰ |
| **ç”¨é€”** | ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€è¨­è¨ˆ | å‹ç”Ÿæˆã€Contract Testing |
| **å ´æ‰€** | `openspec/` | `openapi.json` |

ä¸¡æ–¹ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ï¼š
- âœ… äººé–“ãŒç†è§£ã—ã‚„ã™ã„ä»•æ§˜ï¼ˆOpenSpecï¼‰
- âœ… æ©Ÿæ¢°ãŒå®Ÿè¡Œã§ãã‚‹ä»•æ§˜ï¼ˆOpenAPIï¼‰
- âœ… å®Œå…¨ãªå‹å®‰å…¨æ€§
- âœ… è‡ªå‹•åŒ–ã•ã‚ŒãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

**= å®Œç’§ãªSpecé§†å‹•é–‹ç™º** ğŸ¯
